# 1248. 统计「优美子数组」

给你一个整数数组 `nums` 和一个整数 `k`。

如果某个 **连续** 子数组中恰好有 `k` 个奇数数字，我们就认为这个子数组是「**优美子数组**」。

请返回这个数组中「优美子数组」的数目。



**示例：**

```
输入：nums = [1,1,2,1,1], k = 3
输出：2
解释：包含 3 个奇数的子数组是 [1,1,2,1] 和 [1,2,1,1] 。
```



## 前缀和 + 差分

```java
class Solution {
    public int numberOfSubarrays(int[] nums, int k) {
        int N = nums.length;
        int[] cnt = new int[N+1]; cnt[0] = 1;
        int odd = 0, res = 0;
        for (int i = 0; i < N; i++) {
            odd += nums[i] & 1;
            cnt[odd] += 1;
            res += odd >= k ? cnt[odd - k] : 0;
            
        }
        return res;
    }
}
```



## 前缀和 + 遍历 + 剪枝

```java
class Solution {
    public int numberOfSubarrays(int[] nums, int k) {
        int N = nums.length;
        int[] preOdd = new int[N+1];
        for (int i = 1; i <= N; i++) {
            if (nums[i-1]%2 == 1) {
                preOdd[i] = preOdd[i-1] + 1;
            } else {
                preOdd[i] = preOdd[i-1];
            }
        }


        int res = 0, cnt = 0, preCnt = 0;
        for (int le = 0; le <= N; le++) {
            if (preOdd[N]-preOdd[le]<k) break;
            
            if (preCnt != 0 && nums[le-1]%2 == 0) {
                res += preCnt;
                continue;
            }
            
            for (int ri = le+k; ri <= N; ri++) {
                int tk = preOdd[ri]-preOdd[le];
                if (tk > k) break;
                if (tk == k) cnt++;
            }

            res += cnt;
            preCnt = cnt;
            cnt = 0;
        }
        return res;
    }
}
```

